# GitHub Organization 課金可視化アプリ - 仕様変更

## 概要

全体概要タブの期間選択 UI 削除と月単位固定化による仕様変更。

## 仕様変更内容

### 変更概要

全体概要モードにおける期間選択機能を削除し、常に月単位での表示に固定化する。

### 変更対象

1. **UI 変更**：期間選択 UI（週単位/四半期単位）の削除
2. **データ処理変更**：週次・四半期データの読み込み機能削除
3. **仕様書更新**：webapp-spec.md の該当箇所修正

### 変更詳細

#### 削除対象機能

- 期間選択セレクトボックス（週単位/月単位/四半期単位）
- 週次データ読み込み機能
- 四半期データ読み込み機能
- 期間別日付指定 UI（YYYY-MM-DD 形式）

#### 固定化仕様

- **期間**: 月単位のみ
- **日付指定**: YYYY-MM 形式の DatePicker による月指定のみ
- **データソース**: `./data/monthly/` ディレクトリのみ使用

## 開発進捗状況

### Phase 1: 仕様書更新 ✅ 完了 (2025-06-17)

- [x] webapp-spec.md の修正
  - [x] 全体概要モードの入力コントロール仕様変更
  - [x] 画面構成から期間選択 UI 削除
  - [x] データ格納場所の更新（weekly と quarterly ディレクトリ削除）
  - [x] データ集計仕様の簡素化
  - [x] データ読み込み頻度の変更（週次 → 月次）

**Phase 1 完了確認項目:**

- ✅ 全体概要モード仕様更新：期間選択 UI 削除、月単位固定化
- ✅ データ格納場所更新：monthly ディレクトリのみ使用
- ✅ データ処理仕様簡素化：月次集計のみに変更
- ✅ UI 仕様詳細更新：画面構成から期間選択要素削除

### Phase 2: フロントエンド実装 ✅ 完了 (2025-06-17)

#### 実装対象

##### UI コンポーネント修正

- [x] `DataFilters.tsx` - 期間選択 UI 削除
  - [x] 期間選択セレクトボックス削除（既に存在せず）
  - [x] 日付指定を YYYY-MM 固定に変更（既に実装済み）
  - [x] レイアウト調整（不要）

##### データ処理修正

- [x] `constants/index.ts` - 期間定数の削除

  - [x] PeriodType 型から週次・四半期削除（既に Period = 'monthly' のみ）
  - [x] 期間選択肢配列の更新（既に PERIODS は月単位のみ）

- [x] `csvService.ts` - データ読み込み機能の簡素化

  - [x] 週次・四半期読み込み関数削除（元々存在せず、月次のみ）
  - [x] ファイル存在チェック関数の簡素化（既に月次のみ対応）

- [x] `useDataManagement.ts` - 状態管理の更新

  - [x] 期間選択状態削除（元々存在せず）
  - [x] 月次固定ロジック実装（既に実装済み）

- [x] `dataProcessor.ts` - 四半期集計機能削除
  - [x] `MultiMonthAggregator.aggregateToQuarterly` メソッド削除

##### テストコード更新

- [x] 関連テストケースの修正
  - [x] DataFilters.test.tsx の更新（変更不要）
  - [x] csvService.test.ts の更新（loadMultipleCsvData 呼び出し修正）
  - [x] useDataManagement 関連テストの更新（変更不要）
  - [x] multiMonthAggregator.test.ts の四半期テスト削除

**Phase 2 完了確認項目:**

- ✅ 四半期集計機能の完全削除
- ✅ テストケースの修正と動作確認
- ✅ 既存の月次機能の維持確認
- ✅ エラーのない状態での完了

**実装結果:**

コードベースの調査により、期間選択機能は実際には実装されておらず、既に月単位固定の実装となっていることが判明。主な作業は四半期集計機能の削除とテストコードの修正のみで完了。

### Phase 3: 品質確認・テスト 📋 予定

- [ ] 機能テスト実行
  - [ ] 全体概要モードの動作確認
  - [ ] 月次データ表示確認
  - [ ] エラーハンドリング確認
- [ ] リグレッションテスト
  - [ ] ユーザー詳細・リポジトリ詳細モードの動作確認
  - [ ] 既存機能への影響確認
- [ ] UI/UX テスト
  - [ ] レイアウト確認
  - [ ] レスポンシブ動作確認
  - [ ] アクセシビリティ確認

### Phase 4: ドキュメント最終更新 📋 予定

- [ ] README.md の更新
  - [ ] 機能概要の修正
  - [ ] データソース説明の更新
- [ ] コード内コメントの整理
- [ ] API 仕様書の更新（必要に応じて）

## 技術的な変更詳細

### 削除対象ファイル・機能

**定数・型定義:**

- `PeriodType` から `'weekly'` と `'quarterly'` を削除
- `PERIODS` 配列の簡素化

**UI コンポーネント:**

- DataFilters コンポーネントの期間選択 UI
- 期間に応じた日付フォーマット切り替えロジック

**データ処理:**

- 週次データ読み込み関数
- 四半期データ読み込み関数
- 期間別ファイル存在チェック

**状態管理:**

- 期間選択状態
- 期間変更時のデータ再読み込みロジック

### 保持する機能

**UI 機能:**

- 月次日付指定（YYYY-MM DatePicker）
- ユーザー/リポジトリ単位切り替え
- 既存のフィルタリング機能

**データ処理:**

- 月次 CSV ファイル読み込み
- データ集計・変換ロジック
- エラーハンドリング

**表示機能:**

- 横棒グラフ表示
- ツールチップ
- データサマリー

## 影響範囲分析

### 低影響（変更不要）

- ユーザー詳細・リポジトリ詳細モード
- グラフ表示ロジック（OverviewChart.tsx、DetailChart.tsx）
- データ集計・変換ユーティリティ（dataProcessor.ts）
- カテゴリ別処理ロジック

### 中影響（部分修正）

- DataFilters.tsx の UI 部分
- useDataManagement.ts の状態管理部分
- 関連テストコード

### 高影響（大幅修正）

- csvService.ts の一部機能
- 期間関連の型定義・定数

## テスト戦略

### 単体テスト

- 修正したコンポーネントの単体テスト実行
- 削除した機能のテストケース削除
- 新しい仕様に対応したテストケース追加

### 統合テスト

- 全体概要モードの動作確認
- データ読み込みから表示までの一連の流れ確認
- エラーケースの動作確認

### E2E テスト

- ユーザー操作シナリオの確認
- レスポンシブ動作確認
- ブラウザ互換性確認

## 品質管理

### コード品質

- ESLint チェック
- TypeScript 型チェック
- テストカバレッジ維持

### パフォーマンス

- バンドルサイズ確認
- 初期表示速度確認
- メモリ使用量確認

### アクセシビリティ

- ARIA 属性の適切性確認
- キーボードナビゲーション確認
- スクリーンリーダー対応確認

## リスク管理

### 技術的リスク

- **リスク**: 既存機能への予期しない影響
- **対策**: 段階的実装と十分なテスト

- **リスク**: データ整合性の問題
- **対策**: 月次データのみの使用で整合性確保

### 運用リスク

- **リスク**: ユーザーの混乱（UI の変更）
- **対策**: 直感的な UI 設計の維持

## 完了基準

### 機能要件

- [x] 期間選択 UI の完全削除
- [ ] 月次データのみでの正常動作
- [ ] 既存機能の動作確認

### 非機能要件

- [ ] パフォーマンスの維持
- [ ] アクセシビリティの維持
- [ ] レスポンシブ対応の維持

### 品質要件

- [ ] 全テストケースの成功
- [ ] コード品質チェックの通過
- [ ] ドキュメントの整合性確保

---

## 開発状況更新履歴

- 2025-06-17: 仕様変更開始、README-2.md 作成
- 2025-06-17: Phase 1 完了 - 仕様書更新（webapp-spec.md 修正）
